# -*- mode: ruby -*-
# -*- encoding: utf-8 -*-

Packager.build do
  centos do
  end
  ubuntu do
    target do
      platform 'ubuntu'
      version '12.04'
      package 'deb'
      arch 'amd64'
    end
    dependencies do
      runtime ['libc6']
    end
    build do
      name 'hw-redis'
      template :generic
      commands do
        build [
          'make distclean',
          'make',
          'make PREFIX=$PKG_DIR/usr/local install',
          'mkdir $PKG_DIR/var/redis -p',
          'mkdir $PKG_DIR/etc/redis/utils -p',
          'mkdir $PKG_DIR/etc/init.d/ -p',
          'cp utils/install_server.sh $PKG_DIR/etc/redis/utils',
          'cp utils/redis_init_script $PKG_DIR/etc/init.d/redis_6379',
          'cp redis.conf $PKG_DIR/etc/redis/6379.conf',
          'cp redis.conf $PKG_DIR/etc/redis/redis.conf'
        ]
      end
    end
  end
end
